"use strict";const fs=require("fs-extra"),waterfall=require("async/waterfall"),path=require("path"),glob=require("glob"),cmd=require("fedtools-commands"),log=require("fedtools-logs"),backup=require("../../utilities/backup"),common=require("../../common");module.exports=function(a,b){const c=path.join(process.env.HOME,"Library","QuickLook"),d=path.join(common.ENVTOOLS.THIRDDIR,"quicklook");waterfall([function(a){return fs.existsSync(c)?(backup(c),a()):void fs.ensureDir(c,function(b){a(b)})},function(a){let b,e;glob(`${d}/*.qlgenerator`,{},function(d,f){if(!d&&f)for(e=f.length,b=0;b<e;b++)fs.removeSync(path.join(c,path.basename(f[b])));a(d)})},function(a){fs.copy(d,c,a)},function(a){cmd.run("qlmanage -r",{status:!1},a)}],function(c){c||log.success("QuickLook Plugins successfully installed"),b(c,a)})};