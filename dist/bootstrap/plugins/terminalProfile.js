'use strict';var fs=require('fs-extra'),waterfall=require('async/waterfall'),path=require('path'),inquirer=require('inquirer'),cmd=require('fedtools-commands'),log=require('fedtools-logs'),common=require('../../common');module.exports=function(a,b){waterfall([function(b){return a.auto?b():void inquirer.prompt({type:'confirm',name:'goForIt',message:'About to install a custom Terminal profile, continue?',default:!0}).then(function(c){return a.actionsPending++,c.goForIt?(a.actionsDone++,b()):b(common.USER_INTERRUPT)})},function(b){var c,d=[],e='Envtools.terminal',f=path.join(process.env.HOME,'Desktop',e),g=path.join(common.ENVTOOLS.THIRDDIR,'terminal',e);c='open '+g,cmd.run(c,{status:!1},function(h){if(h){if(a.auto)return b(common.USER_IGNORE);fs.copy(g,f,function(){return d.push(log.strToColor('yellow','                      I N S T R U C T I O N S\n')),d.push('A customized Terminal profile provided by Envtools has been dropped'),d.push('on your desktop. You need to install it manually, but it\'s a very'),d.push('simple process.\n'),d.push('Open the Terminal, hit <CMD ,> (or just open the Preferences).\n'),d.push('Click on the tab called '+log.strToColor('yellow','"Profiles"')+'. At the bottom left, there is a'),d.push('cog icon next to a + and - icons. Click on it and choose'),d.push(log.strToColor('yellow','"Import..."')+'. Choose the Envtools Theme file on your desktop: the'),d.push('file name is '+log.strToColor('cyan',e)+'.\n'),d.push('Scroll to the top of the list of profiles and select Envtools. Click'),d.push('on '+log.strToColor('yellow','"Default"')+' - next to the previous cog button, and you are set!\n'),d.push('Open a new terminal window and enjoy!'),log.printMessagesInBox(d),b(common.USER_IGNORE)})}else c='osascript -e \'tell application "Terminal"\nset default settings to settings set "Envtools"\nend tell\'',cmd.run(c,{status:!1},function(c){return a.auto?b(common.USER_IGNORE):(c?(d.push(log.strToColor('yellow','                      I N S T R U C T I O N S\n')),d.push('A customized Terminal profile provided by Envtools has been automatically'),d.push('installed. To make it a default is a very simple process.\n'),d.push('Open the Terminal preferences and click on the tab called '+log.strToColor('yellow','"Profiles"')+'.\n'),d.push('Scroll to the top of the list of profiles and select Envtools. Click'),d.push('on '+log.strToColor('yellow','"Default"')+' - next to the bottom left cog button, and you are set!\n'),d.push('Open a new terminal window and enjoy!'),log.printMessagesInBox(d)):log.success('Terminal profile successfully installed!'),b(common.USER_IGNORE))})})}],function(c){b(c,a)})};