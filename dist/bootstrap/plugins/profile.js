'use strict';const waterfall=require('async/waterfall'),path=require('path'),fs=require('fs-extra'),utilities=require('fedtools-utilities'),backup=require('../../utilities/backup'),common=require('../../common'),DOT_HUSHLOGIN=path.join(process.env.HOME,'.hushlogin');function setAutoLoad(a,b){function c(a,b,c){const d=path.join(__dirname,'..','..','..','shell'),e=[common.ENVTOOLS.DOT_PROFILE_COMMENT];'win32'===process.platform&&e.push(`export ENVTOOLS_ENVDIR="${d}"`),e.push(`source "${path.join(d,'load.sh"')}`),backup(a),fs.ensureFileSync(a),b===common.ON?utilities.appendLinesInFile({lines:e,file:a},function(a){c(a)}):utilities.removeLinesInFile({lines:e,file:a},function(a){c(a)})}return a.auto&&process.env.ENVTOOLS_VERSION?b(null,a):void function(b,d){waterfall([function(a){c(common.DOT_PROFILE,b,a)},function(a){c(common.DOT_BASH_PROFILE,b,a)},function(a){c(common.DOT_ZSH_PROFILE,b,a)},function(a){fs.writeFile(DOT_HUSHLOGIN,'',function(){a()})}],function(b){d(b,a)})}(a.toggleOptions[common.ENVTOOLS.CFG_AUTOLOAD],function(){b(null,a)})}exports.setAutoLoad=setAutoLoad;