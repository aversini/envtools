'use strict';var fs=require('fs-extra'),inquirer=require('inquirer'),glob=require('glob'),waterfall=require('async/waterfall'),each=require('async/each'),path=require('path'),log=require('fedtools-logs'),decompress=require('decompress'),backup=require('../../backup'),common=require('../../common');function _installScreensavers(a,b){var c=path.join(common.ENVTOOLS.THIRDDIR,'screensavers/*.tgz'),d=path.join(process.env.HOME,'Library','Screen Savers');waterfall([function(a){inquirer.prompt([{type:'confirm',name:'install',message:'Extra screensavers will be installed, continue?',default:!0}]).then(function(b){return b.install?a():a(common.USER_INTERRUPT)})},function(a){glob(c,{nosort:!0,nocase:!0},function(b,c){return!b&&c?void each(c,function(a,b){decompress(a,d).then(function(){b()},function(){b()})},function(b){a(b)}):a()})}],function(c){c||(log.success('Extra screensavers have been successfully installed!'),c=common.USER_IGNORE),b(c,a)})}function _fixScreensaverSettings(a,b){var c,d,e=[],f=path.join(process.env.HOME,'Library','Preferences','ByHost');waterfall([function(a){inquirer.prompt([{type:'confirm',name:'change',message:'Screensaver configuration files will be cleaned, continue?',default:!0}]).then(function(b){return b.change?a():a(common.USER_INTERRUPT)})},function(a){glob(f+'/com.apple.screensaver*',{nosort:!0,nocase:!0},function(b,g){if(!b&&g)for(d=g.length,c=0;c<d;c++)backup(path.join(f,path.basename(g[c]))),fs.removeSync(path.join(f,path.basename(g[c])));e.push('Screensaver configuration files have been cleaned.'),e.push('Please logout or restart before accessing the\nscreensaver configuration panel again.'),log.printMessagesInBox(e,common.LOG_COLORS.DEFAULT_BOX),a()})}],function(c){b(c,a)})}module.exports={fix:_fixScreensaverSettings,install:_installScreensavers};